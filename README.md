# PULP System Verilog evaluation benchmark for large language model

This repository creates a benchmark dataset from some of the open-source PULP
designs in System Verilog, with the goal of using the benchmark to assess
LLM-based RTL design and verification capabilities.

The reference RTL designs and testbenches are generated as single-source,
self-contained files from the original PULP source code using `bender` and
`morty`. Specification prompts are generated by an LLM.

The idea of this repository is inspired by
[verilog-eval](https://github.com/NVlabs/verilog-eval) from NVIDIA.

## Dependencies
* Bender >= 0.27.1
* Morty >= 0.9.0
* Python >= 3.11

## Getting started

This project uses Git submodules that have to be initialized. Either clone the repository recursively using:

```bash
git clone --recursive <url>
```

or fetch the submodules afterwards in the repository:

```bash
git submodule update --init --recursive
```

## Setup

Install the dependencies:

```sh
# get latest stable rust
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

# bender
cargo install bender

# morty
cargo install --git https://github.com/pulp-platform/morty.git

# python environment
python3.11 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

## Usage

The list of (RTL DUT, TB) pairs and their original asset have to be listed in a
JSON file. We provide a sample file in `$ROOT/benchmarks.json` file. Then call:

```bash
./scripts/bench-gen.sh --json benchmarks.json --out out/
```

## Output

| Name                        | Description                                                                                              |
|-------------------------------------|----------------------------------------------------------------------------------------------------------|
| `ProbXXX_<dut_name>_ref.sv`         | Reference DUT RTL design for automatic spec generation.                                                  |
| `ProbXXX_<dut_name>_test.sv`        | Reference testbench for the DUT. Used by the assessed LLM to verify its generated RTL DUT in-the-loop. TBs are self-checking. |
| `ProbXXX_<dut_name>_test_golden.sv` | Reference testbench instantiating the reference DUT. Serves as a golden reference for comparison with the LLM-generated RTL DUT. |
| `ProbXXX_<dut_name>_prompt.txt`     | LLM-generated prompt based on the reference design and testbench. Can also be written from scratch if a reference design is missing. |

An example output with the design `fifo_v3` from PULP platform's
[common_cells](https://github.com/pulp-platform/common_cells) is provided in
`out/`.
